---
lang: ru
layout: article_with_sidebar
updated_at: '2018-03-02 11:52 +0300'
identifier: ref_1yLiVv5G
title: 'Синхронизация X-Cart с 1С:Предприятие'
order: 60
published: false
---
Если вы ведёте бухгалтерский учёт в **"1С:Предприятие"**, воспользуйтесь модулем **1C integration** для обмена данными между магазином X-Cart и системой учёта.

Модуль 1C integration
Установка модуля
Настройка модуля 
Настройка синхронизации в "1С:Предприятие"
Настройка выгрузки товаров на сайт
Типовое соглашение
Выбор товаров для выгрузки
Настройка обмена заказами
Создание дополнительных реквизитов
Настройка полей обмена заказами

## Модуль 1C integration
Модуль интеграции магазина X-Cart c системой "1С:Предприятие" выполнен в соответствии с [протоколом обмена между системой 1С:Предприятие" и сайтом](http://v8.1c.ru/edi/edi_stnd/131/ "Синхронизация X-Cart с 1С:Предприятие"). 

Обмен данными между X-Cart и "1С:Предприятие" происходит через файлы формата _CommerceML_.

В зависимости от настроек модуля, магазин принимает и обновляет, или полностью перезаписывает данные о товарах: категории каталога и товары с названиями, описаниями, фотографиями, ценами, опциями, производителями.

Синхронизация данных о заказах проходит в обеих системах: 
- в X-Cart - магазин принимает данные об изменениях в заказах. 
- в "1С:Предприятие" - система запрашивает информацию об изменениях в заказах, и магазин предоставляет её в _CommerceML_ файле.

## Установка модуля
В магазинах версии _Всё включено (X-Cart Ultimate)_ модуль **Интеграция с "1С:Предприятие" (1C integration)** уже установлен и требует только {% link "активации" ref_IEo2gFuZ %}. Для магазинов _X-Cart Базовый, Бизнес_ и  _Мультивендор_ модуль требуется {% link "установить из маркетплейса" ref_gpeZtm28 %}.

## Настройка модуля

После установки модуля перейдите по ссылке **Настройки** 

![1.jpg]({{site.baseurl}}/attachments/ref_1yLiVv5G/1.jpg)

или откройте страницу **Заказы / Бухгалтерия / 1C Integration / Настройки**.

![2.jpg]({{site.baseurl}}/attachments/ref_1yLiVv5G/2.jpg)

### Настройка синхронизации в "1С:Предприятие"

Войдите в учётную запись "1С:предприятие", которая даёт доступ к настройкам **НСИ и Администрирование**.
В разделе **НСИ и Администрирование / Настройка интеграции** выберите пункт **Синхронизация данных**.

![for_1c_manual_03.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_03.png)

На странице настройки синхронизации данных активируйте опции (поставьте галочки) **Синхронизация данных** и **Обмен данными с сайтами**, затем нажмите **Узлы обмена с сайтами**.

![for_1c_manual_04.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_04.png)

На открывшейся странице со списком узлов обмена с сайтами создайте новый узел. Затем на странице редактирования узла выберите необходимый **Режим обмена данными**. Для примера выберем оба режима: **Выгрузка товаров** и **Обмен заказами**.

{% note info %}
При необходимости настройте несколько узлов обмена данными с различной периодичностью действия (для выгрузки товаров, для обмена заказами, для выгрузки части товаров и т.п.).  
{% endnote %}

В секции **Способ обмена данными** выберите опцию **Выгружать на сайт**.

Затем в поле **Адрес сайта**вставьте ссылку на магазин. Скопируйте точный адрес ссылки со страницы параметров модуля **1С integration** в X-Cart (**Заказы / Бухгалтерия / 1C integration / Настройки**).

Поля **Имя пользователя** и **Пароль** можно не заполнять.

Нажмите кнопку **Проверить соединение**. Если синхронизация настроена правильно, появится подтверждение:

![for_1c_manual_05.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_05.png)

Активируйте опцию **Автоматический обмен** и настройте периодичность, чтобы система "1С:Предприятие" производила обмен данными автоматически по заданному расписанию.

Когда связь с сайтом успешно установлена, приступайте к настройкам непосредственно выгрузки товаров и обмена заказами.

## Настройка выгрузки товаров на сайт

### Типовое соглашение

Для выгрузки товаров из системы “1С:Предприятие” на сайт понадобится специально настроенное **Типовое соглашение об условиях продаж**.

Пройдите в раздел **CRM и маркетинг** и в меню **НСИ продаж** выберите пункт **Типовые соглашения с клиентами**.

![for_1c_manual_06.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_06.png)

На открывшейся странице со списком типовых соглашений нажмите **Создать**. Заполните поля на вкладке **Основное**. Поле **Сегмент клиентов** оставьте пустым (в некоторых конфигурациях сситемы "1С:Предприятие" оно может называться **Сегмент партнёров**).

![for_1c_manual_07.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_07.png)

Соглашение должно быть актуальным на момент выгрузки данных. Установите статус **Действует** и даты проведения выгрузки товаров на сайт. Если оставить поля дат пустыми, соглашение будет бессрочным.

Затем установите настройки на вкладке **Условия продаж**. В нашем примере мы выставили настройки следующим образом:

![for_1c_manual_08.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_08.png)

{% note info %}
В других конфигурациях системы "1С:Предприятие" набор полей отличается от представленного в примере. 
{% endnote %}

Перейдите на вкладку **Прочие условия** и включите опцию **Доступно для обмена с сайтом** (в других конфигурациях системы "1С:Предприятие" эта опция может называться **Доступно внешним пользователям**).

![for_1c_manual_09.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_09.png)

Заполните остальные разделы настроек (вкладки) типового соглашения согласно требованиям своей бухгалтерии. Нажмите кнопку **Сохранить и Закрыть**.

### Выбор товаров для выгрузки

Когда настроено типовое соглашение, вернитесь в настройки узла обмена с сайтом (**НСИ и Администрирование / Настройка интеграции /  Синхронизация данных**). Перейдите в раздел **Выгрузка товаров**.

Выберите организацию, товары которой планируете выгрузить на сайт.

Отметьте нужные опции в разделе **Выгружаемые данные**:

- _**Каталог товаров**_ – выгружать товары вместе с категориями, описаниями, значениями атрибутов, производителями);
- _**Файлы изображений**_ – выгружать изображения, если они прикреплены к товарам в системе 1С;
- _**Прочие файлы**_ – выгружать прочие файлы, помимо изображений, если таковые прикреплены к товарам в системе "1С:Предприятие";
- _**Классифицировать товары по видам**_ – выгружать категории товаров из справочника Виды номенклатуры. По умолчанию категории выгружаются из справочника Номенклатура;
- _**Цены по соглашениям и остатки товаров на складах**_ – выгружать цены товаров и остатки на складах. Используйте только эту настройку, чтобы синхронизировать только цены и остатки товаров без выгрузки полной номенклатуры.

В поле **Склады доступные для выбора на сайте** выберите склад или группу складов, откуда будете выгружать данные об остатках товаров.

Выберите режим выгрузки: **все данные** или **только изменения**.

![for_1c_manual_10.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_10.png)

В разделе **Таблица каталогов** настройте товарные каталоги, которые будете выгружать на сайт.

Нажмите кнопку **Добавить** и введите название каталога в поле **Каталог**. Это название только для информации, оно не обрабатывается на стороне магазина.

Поле **Группы номенклатуры** может называться **Виды номенклатуры** в зависимости от выбранной настройки **Классифицировать товары по видам**. Если не заполнять это поле, товарные категории для выгрузки будут выбраны из всей номенклатуры или её видов.

Поле **Идентификатор каталога** содержит уникальный идентификатор, который связывает товары и категории в процессе обработки выгрузки на стороне магазина.

Поле **Отбор** содержит условия выбора товаров для выгрузки на сайт.

![for_1c_manual_11.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_11.png)

Нажмите на это поле, откроется **Формы настройки отбора**.

По умолчанию форма содержит три поля:
- _**Настройка**_ –  параметры отбора товаров для выгрузки;
- _**Вид сравнения**_ – логические операторы (условия) отбора товаров по каждому параметру;
- _**Значение**_ – значения параметров.

Установите необходимые условия выгрузки.

Затем выберите параметр **Соглашение**, задайте для него вид сравнения **равно,** в качестве значения выберите из списка **типовое соглашение**, которое создали специально для выгрузки товаров на сайт (см. пункт ”Типовое соглашение” <ссылка>).

В нашем примере мы выбрали следующие условия выгрузки:

![for_1c_manual_12.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_12.png)

Если необходимо, добавьте несколько каталогов для выгрузки и для каждого установите свои фильтры настройки отбора.

Обязательно установите типовое соглашение для выгрузки товаров для параметра **Соглашение**. Если не указано верное значение параметра, "1С:Предприятие" не выгружает товары на сайт.

Настройка выгрузки товаров на сайт завершена.

### Настройка обмена заказами

На вкладке **Обмен заказами** почти все поля обязательны для заполнения.

Чтобы заполнить поля **Дата заказа на сайте** и **Номер заказа на сайте**, создайте специальные **Дополнительные реквизиты**.

#### Создание дополнительных реквизитов

Откройте пункт меню **Главное** и в разделе **НСИ** выберите **Номенклатура**.

![for_1c_manual_13.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_13.png)

Выделите любой товар (в нашем примере - "1С Бухгалтерия 8. Базовая версия"), нажмите **Еще** и выберите пункт **Изменить состав дополнительных реквизитов**.

![for_1c_manual_14.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_14.png)

Откроется список дополнительных реквизитов, выберите пункт **Список заказов клиентов**. 

Нажмите **Еще** и выберите пункт **Добавить / Новый**.

![for_1c_manual_15.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_15.png)

Откроется диалог создания нового дополнительного реквизита. Создайте два дополнительный реквизита - **дата заказа товара на сайте** и **номер заказа**. 

В поле **Наименование** укажите название дополнительного реквизита. Для примера мы назвали реквизит **Дата заказа**.

В поле **Тип значения** выберите **Дополнительное значение**, в окне редактирования типа данных снимите галку **Составной тип данных** и выберите тип **Строка**. Подтвердите выбор.

Нажмите **Записать и закрыть**. Повторите те же действия для создания второго дополнительного реквизита **Номер заказа**.

![for_1c_manual_16.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_16.png)

Когда необходимые дополнительные реквизиты созданы, вернитесь к настройкам узла обмена с сайтом  (**НСИ и Администрирование / Настройка интеграции /  Синхронизация данных**) и перейдите в раздел **Обмен заказами**.

### Настройка полей обмена заказами

В поля **Дата заказа** на сайте и **Номер заказа на сайте** внесите только что созданные дополнительные реквизиты.

В поле **Соглашение** укажите созданное ранее типовое соглашение для выгрузки товаров.

Заполните остальные поля секций **Реквизиты для создания документов _Заказ клиента_** и **Реквизиты для создания новых элементов справочника _Номенклатура_** в соответствии с требованиями своей бухгалтерии.

![for_1c_manual_17.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_17.png)

Перейдите на вкладку **Дополнительно** и укажите причину отмены заказа, например, **Нет в наличии**.

Затем заполните секцию **Соответствие статусов заказов в информационной базе и на сайте**.

Найдите статусы заказов на сайте в настройках заказов в X-Cart на странице **Заказы / Статусы ордера** или по адресу <адрес_магазина>/admin.php?target=order_statuses

По умолчанию "1С:Предприятие" настраивает соответствие статусов следующим образом:

![for_1c_manual_18.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_18.png)

Настройка завершена,  нажмите **Записать и закрыть**. Перейдите к списку узлов обмена, выделите нужный и нажмите кнопку **Выполнить обмен**.

Дождитесь сообщения об успешном окончании обмена данными. Затем проверьте корректность выгрузки данных в админке магазина.

![for_1c_manual_19.png]({{site.baseurl}}/attachments/ref_1yLiVv5G/for_1c_manual_19.png)

Обратите внимание, в зависимости от используемой конфигурации системы "1С:Предприятие", настройки могут отличаться от описанных в этой статье (названия полей, расположение секций и меню, вид элементов интерфейса).
 